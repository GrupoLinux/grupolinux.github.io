I"©<p>Considerando que j√° tenha configurado o ambiente e esteja funcionando na VPS, incluindo o GIT. Chegou a hora de automatizar o deploy da aplica√ß√£o. Esse √© o objetivo deste post.</p>

<p>Na VPS cria dois diret√≥rios, uma para o reposit√≥rio e outro para aplica√ß√£o</p>

<p>reposit√≥rio: <strong>/var/repo/projeto.git</strong></p>

<p>aplica√ß√£o: <strong>/var/www/html/projeto</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># mkdir /var/repo  
# mkdir /var/repo/projeto.git  
# cd /var/repo/projeto.git  
# git init --bare  
# cd hooks  
# vim post-receive
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash  </span>
git <span class="nt">--work-tree</span><span class="o">=</span>/var/www/html/projeto <span class="nt">--git-dir</span><span class="o">=</span>/var/repo/projeto.git checkout <span class="nt">-f</span>
</code></pre></div></div>

<p>ESC +:wq (Salvar e sair do editor Vim)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># chmod +x post-receive  
# chown -R usuario:usuario /var/repo/projeto.git
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># mkdir /var/www/html/projeto  
# chown R www-data:www-data /var/www/html/projeto
</code></pre></div></div>

<p>Agora na m√°quina de desenvolvimento</p>

<p>Acesse o diret√≥rio do projeto, execute</p>

<p>Adicionar o reposit√≥rio deploy da VPS no remote</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git remote add deploy ssh://usuario@IP_VPS/var/repo/projeto.git  
git add .  
git commit -m "primeiro commit"  
git push origin master  
git push deploy master
</code></pre></div></div>

<p>Para visualizar os commits</p>

<p><code class="highlighter-rouge">git log --all --graph --decorate --oneline</code></p>

<p>Caso ocorra algum erro de permiss√£o, execute o hooks/post-receive manualmente</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#cd /var/repo/projeto.git/hooks  
#./post-receive
</code></pre></div></div>

<p>Feito!</p>
:ET