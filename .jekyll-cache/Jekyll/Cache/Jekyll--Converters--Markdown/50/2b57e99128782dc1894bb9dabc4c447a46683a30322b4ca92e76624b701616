I"(<p>Considerando que já tenha configurado o ambiente e esteja funcionando na VPS, incluindo o GIT. Chegou a hora de automatizar o deploy da aplicação. Esse é o objetivo deste post.</p>

<p>Na VPS cria dois diretórios, uma para o repositório e outro para aplicação</p>

<p>repositório: <strong>/var/repo/projeto.git</strong></p>

<p>aplicação: <strong>/var/www/html/projeto</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># mkdir /var/repo  
# mkdir /var/repo/projeto.git  
# cd /var/repo/projeto.git  
# git init --bare  
# cd hooks  
# vim post-receive
</code></pre></div></div>

<pre><code class="language-#!/bin/bash">git --work-tree=/var/www/html/projeto --git-dir=/var/repo/projeto.git checkout -f
</code></pre>

<p>ESC +:wq (Salvar e sair do editor Vim)</p>

<p>```# chmod +x post-receive</p>
<h1 id="chown--r-usuariousuario-varrepoprojetogit">chown -R usuario:usuario /var/repo/projeto.git</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  
```# mkdir /var/www/html/projeto  
# chown R www-data:www-data /var/www/html/projeto
</code></pre></div></div>

<p>Agora na máquina de desenvolvimento</p>

<p>Acesse o diretório do projeto, execute</p>

<p>Adicionar o repositório deploy da VPS no remote</p>

<p>```git remote add deploy ssh://usuario@IP_VPS/var/repo/projeto.git<br />
git add .<br />
git commit -m “primeiro commit”<br />
git push origin master<br />
git push deploy master</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Para visualizar os commits

`git log --all --graph --decorate --oneline`

Caso ocorra algum erro de permissão, execute o hooks/post-receive manualmente
s
```#cd /var/repo/projeto.git/hooks  
#./post-receive
</code></pre></div></div>

<p>Feito!</p>
:ET